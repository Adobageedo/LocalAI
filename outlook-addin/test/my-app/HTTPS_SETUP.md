# HTTPS Setup for Outlook Add-in Testing

This guide explains how to set up HTTPS for testing the React-based Outlook add-in taskpane.

## Prerequisites

- SSL certificates generated by mkcert (should already exist in the parent directory)
- React app built and ready for production

## Quick Start

### 1. Build the React App

```bash
npm run build
```

### 2. Start HTTPS Server

```bash
npm run start:https
```

The React app will be available at `https://localhost:3000`

## Manual Setup (if needed)

### Generate SSL Certificates

If you don't have SSL certificates, run from the main add-in directory:

```bash
cd ../..
./setup-local-test.sh
```

This will:
- Install mkcert if not already installed
- Generate SSL certificates for localhost
- Set up the local CA

### Verify Certificates

Check that certificates exist:

```bash
ls -la ../../localhost+1*.pem
```

You should see:
- `localhost+1.pem` (certificate)
- `localhost+1-key.pem` (private key)

## Testing with Outlook

### 1. Manifest Configuration

The manifest (`manifest-local.xml`) is already configured to point to:
- `https://localhost:3000` for the React taskpane
- `https://127.0.0.1:8443` for static assets (icons, commands.html)

### 2. Sideload the Add-in

#### Outlook Web (outlook.office.com)
1. Go to Settings (gear icon) → Manage integrations
2. Click "Add-ins" → "My add-ins" → "Add a custom add-in" → "Add from file"
3. Upload `manifest-local.xml`

#### Outlook Desktop
1. Go to File → Manage Add-ins → "My add-ins"
2. Click "Add a custom add-in" → "Add from file"
3. Upload `manifest-local.xml`

### 3. Test the Add-in

1. Open or compose an email in Outlook
2. Look for "Email Template Generator" in the ribbon
3. Click "Generate Template" to open the taskpane
4. The React app should load with authentication and template generation features

## Troubleshooting

### Certificate Issues

If you get SSL certificate errors:

1. Ensure mkcert CA is installed:
   ```bash
   mkcert -install
   ```

2. Regenerate certificates:
   ```bash
   cd ../..
   rm localhost+1*.pem
   mkcert localhost 127.0.0.1
   ```

### Port Conflicts

If port 3000 is in use:

1. Stop other processes using port 3000
2. Or modify `start-https.js` to use a different port
3. Update the manifest URLs accordingly

### Manifest Errors

Common issues:
- Ensure all URLs in the manifest are accessible
- Check that icons exist at the specified paths
- Verify the manifest XML is valid

### React App Issues

If the React app doesn't load:

1. Check the browser console for errors
2. Verify the build completed successfully
3. Ensure Firebase configuration is correct
4. Check that all dependencies are installed

## Development Workflow

### For Active Development

1. Make changes to React components
2. Run `npm run build` to create production build
3. The HTTPS server will serve the updated build
4. Refresh the taskpane in Outlook to see changes

### For Hot Reloading (Development Only)

For development without Outlook testing, use:
```bash
npm start
```

This runs on `http://localhost:3000` with hot reloading but won't work with Outlook due to HTTPS requirement.

## Security Notes

- The SSL certificates are for local development only
- Never use these certificates in production
- The certificates are trusted only on your local machine
- Regenerate certificates if they expire

## Next Steps

Once HTTPS testing is working:

1. Configure Firebase authentication
2. Test email context loading
3. Test AI template generation
4. Verify template insertion works
5. Deploy to production environment
